\documentclass{ximera}
\input{../../preamble.tex}

\author{Zack Reed}
%borrowed from selinger linear algebra
\begin{document}

\begin{problem}

   You've intercepted an encrypted message from an opponent in a cryptography competition: ``VO,VO,QMYF NNESJKDDFSFWNT,,VIZIWUBPTG,Z DI''
   
    NOTE: More problems will appear after you successfully answer the following:

    \begin{enumerate}
        \item You know that your opponent uses a 3-dimensional Hill Cipher, and also that they always start their communication with  ``Yo yo yo.", which when encrypted reads ``VO,VO,QMY''
        
        This information \wordChoice{\choice{is}\choice[correct]{is not}} enough to break the encryption because the cipher text ``VO,VO,QMY'' makes a $3\times 3$ matrix of rank $\answer{2}$, and hence \wordChoice{\choice{is}\choice[correct]{is not}} invertible. Because of this, we \wordChoice{\choice{can}\choice[correct]{cannot}} solve for the inverse of the cipher. 


        \item You know that your opponent uses a 3-dimensional Hill Cipher, and also that they always end their communication with  ``lates fam.", which when encrypted reads ``AC,BBWFLGZ..''
        
        This information \wordChoice{\choice[correct]{is}\choice{is not}} enough to break the encryption because the cipher text ``AC,BBWFLGZ..'' lets you make a $3\times 3$ matrix of rank $\answer{3}$, and hence \wordChoice{\choice[correct]{is}\choice{is not}} invertible. Because of this, we \wordChoice{\choice[correct]{can}\choice{cannot}} solve for the inverse of the cipher. 

        \begin{problem}

            \begin{enumerate}
                \item First, use the known ending ``lates fam.'' in conjunction with the cipher text ``AC,BBWFLGZ..'' to hack the cipher by finding the inverse matrix of the hill cipher. 
                
                The inverse cipher $A^{-1}$ after conversion to the number system $0\rightarrow 28$ (using \texttt{linalg.mod\_p(M,29)} for a matrix $M$) is:

                $$A^{-1}=\begin{bmatrix}
                    \answer{2} & 0 &\answer{24}\\
                    \answer{0} & 6 & 23 \\
                    28 & \answer{17} & \answer{15}
                \end{bmatrix}.$$

                \item Now, translate the entirety of the intercepted message: ``VO,VO,QMYF NNESJKDDFSFWNT,,VIZIWUBPTG,Z DI''
                
                The full translated message reads ``Yo yo yo. $\answer[format=string]{catch me if you can.}$ Lates fam.''
            \end{enumerate}

            \begin{hint}
            
                You'll want to convert each matrix to the number system $0\rightarrow 28$ basically at each step of the way (i.e. convert to mod 29).

                After \texttt{linalg.string\_to\_vector()}, the numbers will be already in mod 29. Once you invert a matrix, or do a matrix multiplication, however, first convert to mod 29 before moving on. 

                For instance, after finding the inverse matrix $A^{-1}$, I'll want to convert to mod 29 before applying $A^{-1}$ to the encrypted matrix. 

                Example:

                \begin{verbatim}
                A=[1 0 1;
                2 1 3;
                1 0 0]
                A_inv=inv(A)
                A_inv=linalg.mod_p(A_inv,29)
                \end{verbatim}

                will find the inverse, $A^{-1}=\begin{bmatrix}
                    0 & 0 & 1\\-3 & 1 & 1\\1 & 0 & -1
                \end{bmatrix}$, which is not mod 29. Before doing anything else for cryptography, the final line of MATLAB converts $A^{-1}$ to mod 29 to yield $A^{-1}=\begin{bmatrix}
                    0 & 0 & 1\\ 26 & 1 & 1 \\ 1 & 0 & 28
                \end{bmatrix}.$

            \end{hint}

            
            
        \end{problem}


    \end{enumerate}

\end{problem}

\end{document}