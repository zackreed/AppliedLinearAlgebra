\documentclass{ximera}
\input{../../preamble.tex}

\author{Zack Reed}
%borrowed from selinger linear algebra
\begin{document}


\begin{problem}
  Consider the following collection of points in $\R^2$:
  \begin{equation*}
    \set{
      \startmat{r} 1 \\ -1 \stopmat,
      \startmat{r} -2 \\ 1 \stopmat,
      \startmat{r} 3 \\ -2 \stopmat,
      \startmat{r} 2 \\ -2 \stopmat,
      \startmat{r} -2 \\ 1 \stopmat,
      \startmat{r} 3 \\ -1 \stopmat,
      \startmat{r} -3 \\ 0 \stopmat,
      \startmat{r} 0 \\ 3 \stopmat,
      \startmat{r} 0 \\ 0 \stopmat,
      \startmat{r} 0 \\ -2 \stopmat
    }.
  \end{equation*}
  Find the 1-dimensional subspace that best approximates this
  collection of points. What is the total squared lengths of the projections onto this subspace? What is the total squared distance of the
  points to the subspace? 

  \begin{solution}
  
    The best-fitting $1D$ subspace is $\text{span}\left(\begin{bmatrix}
      \answer[tolerance=.01]{-.832}\\\answer[tolerance=.01]{.554}
    \end{bmatrix}\right)$. (Note: the vector should be a unit vector with a negative first coordinate rounded to four decimal places.)

    The total squared lengths of the projections onto the subspace is $\answer[tolerance=.5]{52}$. (Hint: Remember that the singular values $\sigma$ capture the norm $\norm{A\vec{v}_1}$, the square root of the dot product of the data with the right singular vector $\vec{v}_1$.)

    The total squared distance of the points to the subspace is $\answer[tolerance=.5]{13}$ (Hint: The singular vectors not spanning the best-fit subspace form basis vectors for $\RR^m$ outside of the best-fit subspace, and the remaining singular values account for the spread along those directions.)

  \end{solution}


\end{problem}

\begin{problem}
  Consider the following collection of points in $\R^3$. Do not assume this has been centered on the origin, plot the points to determine this.
  \begin{equation*}
    \set{
      \startmat{r} 0 \\ 0 \\ 9 \stopmat,
      \startmat{r} 1 \\ 0 \\ -3 \stopmat,
      \startmat{r} 0 \\ 0 \\ 1 \stopmat,
      \startmat{r} 0 \\ 5 \\ -4 \stopmat,
      \startmat{r} 6 \\ -2 \\ 13 \stopmat,
      \startmat{r} 1 \\ 0 \\ 0 \stopmat,
      \startmat{r} 0 \\ 2 \\ 0 \stopmat,
      \startmat{r} 0 \\ 1 \\ 1 \stopmat,
      \startmat{r} 2 \\ 0 \\ 0 \stopmat,
      \startmat{r} 4 \\ 0 \\ 0 \stopmat,
      \startmat{r} 1 \\ -3 \\ 0 \stopmat,
      \startmat{r} 0 \\ 0 \\ 4 \stopmat
    }.
  \end{equation*}
  \begin{enumerate}
  \item Find the 1-dimensional subspace that best approximates this
    collection of points.
  \item Find the 2-dimensional subspace that best approximates this
    collection of points.
  \end{enumerate}
  In each case, what is the total squared distance of the points to
  the subspace? What is the total length of the projections of the points onto the subspace.

  \begin{solution}
    
    \begin{enumerate}
      \item The best-fitting $1D$ subspace is $\text{span}\left(\begin{bmatrix}
        \answer[tolerance=.005]{.2120}\\\answer[tolerance=.005]{-.2192}\\\answer[tolerance=.005]{.9524}
      \end{bmatrix}\right)$ (The direction vector is a unit vector, the first coordinate is positive. Round to four decimal places.)

      The total squared distance of the points to the subspace is $\answer{60}$ (Round to the nearest integer).

      The total spread (i.e. the total squared proejction lengths) is $\answer[tolerance=1]{279}$ (Round to the nearest integer).

      \item The best-fitting $2D$ subspace is $\text{span}\left(\begin{bmatrix}
        \answer[tolerance=.005]{.2120}\\\answer[tolerance=.005]{-.2192}\\\answer[tolerance=.005]{.9524}
      \end{bmatrix},\begin{bmatrix}
        \answer[tolerance=.005]{.6434}\\\answer[tolerance=.005]{-.7022}\\\answer[tolerance=.005]{-.3049}
      \end{bmatrix}\right)$ (The direction vectors are unit vectors, the first coordinate of both vectors is positive. Round to four decimal places.)

      The total squared distance of the points to the subspace is $\answer{22}$ (Round to the nearest integer).

      The total spread (i.e. the total squared proejction lengths) is $\answer[tolerance=1]{316}$ (Round to the nearest integer).
    \end{enumerate}

  \end{solution}

\end{problem}

%\begin{problem}
%  Find the principal components of the matrix
%  \begin{equation*}
%    A = \startmat{ccccccccc}
%      0 & 0 & 0 & 0 & -1 & 0 & 3 & 0 & 1 \\
%      0 & 1 & 0 & 0 & 2 & 3 & 0 & 2 & -1 \\
%      1 & -1 & -3 & 3 & -1 & 0 & 0 & -2 & 2 \\
%    \stopmat.
%  \end{equation*}
%\end{problem}

%\begin{problem}
 % Compute the centroid of the following collection of points:
 % \begin{equation*}
 %   \set{
 %     \startmat{r} 2 \\ -1 \stopmat,
 %     \startmat{r} 0 \\ 1 \stopmat,
 %     \startmat{r} 4 \\ -3 \stopmat,
 %     \startmat{r} -4 \\ -4 \stopmat,
 %     \startmat{r} 0 \\ -2 \stopmat,
 %     \startmat{r} -2 \\ -1 \stopmat,
 %     \startmat{r} 0 \\ -2 \stopmat,
 %     \startmat{r} -2 \\ -4 \stopmat,
 %     \startmat{r} 3 \\ -1 \stopmat,
 %     \startmat{r} -5 \\ -5 \stopmat
 %   }.
 % \end{equation*}
%\end{problem}

%\begin{problem}
%  Consider the following collection of points in $\R^2$:
%  \begin{equation*}
%    \set{
%      \startmat{r} 4 \\ -3 \stopmat,
%      \startmat{r} 10 \\ -9 \stopmat,
%      \startmat{r} 4 \\ -7 \stopmat,
%      \startmat{r} -2 \\ 3 \stopmat,
%      \startmat{r} 10 \\ -3 \stopmat,
%      \startmat{r} 4 \\ -3 \stopmat,
%      \startmat{r} 5 \\ -3 \stopmat,
%      \startmat{r} 4 \\ 1 \stopmat,
%      \startmat{r} -2 \\ -3 \stopmat,
%      \startmat{r} 3 \\ -3 \stopmat
%    }.
%  \end{equation*}
%  Compute the centroid, and then find the 1-dimensional affine
%  subspace that best approximates this collection of points. What is
%  the total squared distance of the points to the subspace?
%\end{problem}

\begin{problem}
  Consider the following collection of points in $\R^3$:
  \begin{equation*}\scriptstyle
    \set{
      \startmat{r} 0 \\ -2 \\ 2 \stopmat,
      \startmat{r} 6 \\ 2 \\ 2 \stopmat,
      \startmat{r} 2 \\ 2 \\ 6 \stopmat,
      \startmat{r} 3 \\ 2 \\ 2 \stopmat,
      \startmat{r} 3 \\ 0 \\ 5 \stopmat,
      \startmat{r} 5 \\ 0 \\ 2 \stopmat,
      \startmat{r} 4 \\ -2 \\ -2 \stopmat,
      \startmat{r} 5 \\ 0 \\ 2 \stopmat,
      \startmat{r} 1 \\ 0 \\ 2 \stopmat,
      \startmat{r} 3 \\ 0 \\ -1 \stopmat,
      \startmat{r} 3 \\ 0 \\ 1 \stopmat,
      \startmat{r} 3 \\ 0 \\ 3 \stopmat,
      \startmat{r} 1 \\ 0 \\ 2 \stopmat,
      \startmat{r} 3 \\ -2 \\ 2 \stopmat
    }.
  \end{equation*}
  Find the 1- and 2-dimensional affine subspaces that best approximate
  this collection of points. What is the total squared
  distance of the points to each subspace?
\end{problem}

\begin{problem}

  The following is an AI-generated image of a lion:

  \begin{center}

      \includegraphics[width=22.62cm, height=20.76cm]{realistic_lion.png}

  \end{center}

  Load $\texttt{lion\_realistic.png}$ into MATLAB as a $1024x1024$ matrix using the following code:

  \begin{verbatim}
    lion=imread("+linalg/lion_realistic.png")
    lion=double(rgb2gray(lion))
    linalg.show_img(lion)
  \end{verbatim}

  Recall that grayscale images are stored as matrices where each matrix entry is a value between $0$ and $255$, and represents the darkness of the pixel at that location.

  Consider the matrix to be a collection of $1024$ vectors each with $1024$ dimensions, where the columns are the vectors and the rows are the dimensions. Essentially, each vertical strip of the image is a $1024$-dimensional vector (you could also do this by rows, but we'll stay with columns as usual).

  After centering, the lion image should look like the following:

  \begin{center}

    \includegraphics[width=22.62cm, height=20.76cm]{realistic_lion_centered.png}

\end{center}

The SVD of the centered lion gives $U$, $S$, and $V$ as $1024\times 1024$ matrices, meaning we have $1024$ possible principal components to work wtih. 

Reconstructing only on the $100$-dimensional best-fit subspace yields the following:

\begin{center}

  \includegraphics[width=22.62cm, height=20.76cm]{realistic_lion_100_vals.png}

\end{center}

What is the difference between the total squared spread on the $100$-dimensional approximation and the total squared spread of the data on the remaining $924$ principal components? 

Answer in scientific notation:

$\answer{2.9}\times 10^{\answer{9}}$ (Round the coefficient to one decimal place.)

\end{problem}


\end{document}