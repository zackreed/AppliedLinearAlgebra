\documentclass{ximera}
\input{../../../preamble.tex}

\author{Zack Reed}
%borrowed from selinger linear algebra
\title{Planes and Hyperplanes}
\begin{document}
\begin{abstract}


\end{abstract}
\maketitle



\section{Planes}
\label{sec:planes}

As promised, we also find better ways to discuss planes and hyperplanes, in accordance with the ideas of normal vectors and the dot product.

First, much like with lines we can extend the notion of planes as $2D$ spans into a vector equation. 

Consider a point $P$ and two direction
vectors $\vect{d}$ and $\vect{e}$ that are not parallel to each
other. 

If $\vec{p}$ is the vector going from the origin to $P$, then any vector $\vec{q}$ on the plane is the result of adding $\vec{p}$ to a linear combination of the direction vectors $\vec{e}$ and $\vec{d}$.

\begin{center}
  \begin{tikzpicture}[rotate=-10]
    \filldraw[draw=red!80,fill=red!10](-2,0,-5) -- (4,0,-5) -- (4,0,2) -- (-2,0,2) -- cycle;
    \draw[->,thick,blue!80!black](0,0,0) -- node[below left] {$\vect{d}$} (2,0,0);
    \draw[->,thick,blue!80!black](0,0,0) -- node[above left] {$\vect{e}$} (0,0,-3);
    \fill (0,0) circle [radius=2.2pt] node [left=3pt] {$P$};
  \end{tikzpicture}
\end{center}

This brings us to the following definition: 


\begin{definition}\name{Vector equation of a plane}\label{def:vector-equation-of-plane}

  Let $\vect{p}$ be a vector and let $\vect{d},\vect{e}$ be non-zero,
  non-parallel vectors. Then
  \begin{equation*}
    \vect{q} = \vect{p} + t\,\vect{d} + s\,\vect{e}
  \end{equation*}
  is the \textbf{vector equation} of the plane offset by $\vec{p}$ and spanned by $\vec{d}$ and $\vec{e}$.
\end{definition}

The vector equation of a plane can also be written in
\textbf{component form}

\begin{equation*}
  \startmat{c} x_1 \\ x_2 \\ \vdots \\ x_n \stopmat
  = \startmat{c} p_1 \\ p_2 \\ \vdots \\ p_n \stopmat
  + t \startmat{r} d_1 \\ d_2 \\ \vdots \\ d_n \stopmat,
  + s \startmat{r} e_1 \\ e_2 \\ \vdots \\ e_n \stopmat.
\end{equation*}

\begin{example}\name{Vector and parametric equations}\label{ex:plane-from-three-points}
  Find the plane through the
  points $P = (1,2,0,0)$, $Q = (2,2,0,1)$, and $R = (0,1,1,0)$.
\end{example}

\begin{solution}
  We can use $P$ as the base point and $\longvect{PQ}$ and
  $\longvect{PR}$ as the direction vectors. We have
  \begin{equation*}
    \longvect{PQ} =
    \startmat{c} 2\\2\\0\\1 \stopmat
    - \startmat{c} 1\\2\\0\\0 \stopmat
    = \startmat{c} 1\\0\\0\\1 \stopmat
    \quad\mbox{and}\quad
    \longvect{PR} =
    \startmat{c} 0\\1\\1\\0 \stopmat
    - \startmat{c} 1\\2\\0\\0 \stopmat
    = \startmat{c} -1\\-1\\1\\0 \stopmat.
  \end{equation*}

  Therefore the vector equation is

  \begin{equation*}
    \startmat{c} x\\y\\z\\w \stopmat
    = \startmat{c} \answer{1}\\\answer{2}\\\answer{0}\\\answer{0} \stopmat
    + t\,\startmat{c} \answer{1}\\\answer{0}\\\answer{0}\\\answer{1} \stopmat
    + s\,\startmat{c} \answer{-1}\\\answer{-1}\\\answer{1}\\\answer{0} \stopmat.
\end{equation*}
\end{solution}

In the special case of 3 dimensions, a plane can also be described by
a point and a normal vector, $\vec{n}$. This leverages the strategy hinted at in the previous section, where we determined whether a point was on a line by checking orthogonality with a vector $\vec{n}$ that was orthogonal to the line's direction vector.

In $\RR^3$ in particular, planes take up $2$ out of $3$ dimensions in the space, and so it is often more efficient and at times very beneficial to describe planes using only a single vector $\vec{n}$, rather than the two direction vectors. This kind of strategy comes up quite often in engineering and the sciences, and if you've taken vector calculus this idea should be familiar to you.

First, a \textbf{normal vector} of a plane is a vector that is
perpendicular to the plane.
\begin{center}
  \begin{tikzpicture}[rotate=-10]
    \filldraw[draw=red!80,fill=red!10](-3,0,-3.5) -- (3,0,-3.5) -- (3,0,3.5) -- (-3,0,3.5) -- cycle;
    \draw[->,thick,blue!80!black](0,0,0) -- node[left, pos=0.4] {$\vect{n}$} (100:2);
    \draw[dashed,gray](0,0,0) -- (2,0,-2);
    \fill (0,0,0) circle [radius=2.2pt] node [left=3pt] {$P$};
    \fill (2,0,-2) circle [radius=2.2pt] node [right=3pt] {$Q$};
  \end{tikzpicture}
\end{center}

Given a non-zero vector $\vect{n}$ in $\R^3$ and a point $P$, there
exists a unique plane that contains $P$ and has $\vect{n}$ as a normal
vector. This is because, again, the plane takes up $2/3$ of the dimensions of $\RR^3$, meaning that the rest of $\RR^3$ is characterized only by variation along a single remaining axis. While any vector not on the plane will suffice, only one vector $\vec{n}$ (or its negative) will be orthogonal to the plane. Hence, normal vectors allow us to strategically characterize planes succinctly.

To visualize this phenomenon, again create an orthonormal basis of $\RR^3$ using the following GeoGebra applet, but attend to the constraining of the final vector to a single direction (or its negative) to maintain the orthogonality.

\begin{center}
  \geogebra{ym8uzusc}{859}{457}
\end{center}


We wish to find an equation for this plane. The key feature of the normal vector is that it is orthogonal to any vector spanned by the plane's direction vectors $\vec{d}$ and $\vec{e}$. So, if any vector $\vec{q}$ is on the plane, then after un-shifting by $\vec{p}$ we should have a vector orthogonal to $\vec{n}$. This gives us our nice succinct definition of the plane.


\begin{equation*}
  \vect{n} \dotprod (\vect{q}-\vect{p}) = 0,
\end{equation*}
or equivalently,
\begin{equation*}
  \vect{n} \dotprod \vect{q} = \vect{n} \dotprod \vect{p}.
\end{equation*}

This is called the \textbf{normal equation} of the plane. Note that in
this equation, $\vect{n}$ and $\vect{p}$ are given and fixed, whereas
$\vect{q}$ is a variable ranging over the position vectors of all
points on the plane.



\begin{definition}\name{Normal equation of a plane in $\R^3$}\label{def:normal-equation-plane}

  Let $\vect{n}$ be a non-zero vector in $\R^3$, and let $P$ be a
  point with position vector $\vect{p}$. Then there is a unique plane through
  $P$ with normal vector $\vect{n}$. It is described by the equation
  \begin{equation*}
    \vect{n} \dotprod (\vec{p}-\vect{q}) = 0.
  \end{equation*}
  This equation is called the \textbf{normal equation} of the plane.
\end{definition}

\begin{example}\name{Finding the normal equation of a plane}\label{ex:normal-equation}

  Find the normal equation of the plane through the point $P=(1,3,0)$
  and orthogonal to $\vect{n}=\startmat{c}2\\1\\1\stopmat$.
\end{example}

\begin{solution}
  Let $\vect{p}=\startmat{c}1\\3\\0\stopmat$ be the position vector of $P$, and let
  $\vect{q}=\startmat{c}x\\y\\z\stopmat$ be the position vector of some arbitrary
  point $Q$ in the plane. 
  
  The normal equation is
  $\vect{n} \dotprod (\vec{q}-\vect{p}) = 0.$, which we
  can write in component form:

  \begin{equation*}
    \startmat{c}\answer{2}\\\answer{1}\\\answer{1}\stopmat
    \dotprod
    \startmat{c}x-\answer{1}\\y-\answer{3}\\z-\answer{0}\stopmat
    =0.
  \end{equation*}

  If we take the other form of the normal equation 
  
  $$vect{n} \dotprod \vect{q} = \vect{n} \dotprod \vect{p},$$
  
  we can pre-compute the dot product on the right-hand side:
  $\vect{n} \dotprod \vect{p} = \answer{5}$. 
  
  Therefore, the
  normal equation can also be written as

  \begin{equation*}
    \startmat{c}\answer{2}\\\answer{1}\\\answer{1}\stopmat
    \dotprod
    \startmat{c}x\\y\\z\stopmat
    = \answer{5}.
  \end{equation*}
\end{solution}

Notice that the last equation in Example~\ref{ex:normal-equation} can
also be written in the form
\begin{equation*}
  2x + y + z = 5.
\end{equation*}

This last form is called the \textbf{standard equation} of the plane.

\begin{definition}{Standard equation of a plane in $\R^3$}{standard-equation-plane}
  Let $\vect{n} = \startmat{c}a,b,c\stopmat^T$ be the normal vector for a plane that
  contains the point $P = (x_0, y_0, z_0)$. The \textbf{standard
    equation}%
  \index{plane!standard equation}%
  \index{standard equation of a plane} of the plane is given by
  \begin{equation*}
    ax + by + cz = d,
  \end{equation*}
  where $a,b,c,d \in \R$ and $d = ax_0 + by_0 + cz_0$.
\end{definition}

This is often the first definition of a plane that you will see in a calculus textbook, but without motivating the definition through normal vectors and dot products it is often a mystery why we can or would write planes in this way (or, it leads to poor generalizations from lines).

\begin{example}\name{Normal and standard equations}\label{exa:normal-from-three-points}

  Find normal and standard equations for the plane through the points
  $P = (0,1,3)$, $Q=(2,-1,0)$, and $R=(1,2,2)$.
\end{example}

\begin{solution}
  We first need to find a normal vector for the plane. This need motivates the final concept of the chapter, the \emph{cross product}, which we will discuss in the next section. So $\ldots$ to be continued!

\end{solution}

\subsection*{Hyperplanes}

As we've discussed, the standard equations of planes can be viewed as manifestations of the {\bf normal equation}, $\vec{n}\cdot\vec{v}=\vec{n}\cdot\vec{p}$ for any $\vec{v}$ on the plane.

As it turns out, this can also characterize the standard equation of the line, and the standard equations for Hyperplanes as well!

In the case of a line, specifically within $\RR^2$, because of how nice $2$-dimensional slopes are, if we have a normal vector $\vec{n}=\begin{bmatrix}
  a\\b
\end{bmatrix}$, we also have the direction vector $\vec{d}=\begin{bmatrix}
  -b\\a
\end{bmatrix}$. If you remember finding normal and tangent lines in calculus, this was from the essential relationship between the slopes of normal and tangent lines.

So, if we situate a line with direction vector $\vec{d}=\begin{bmatrix}
  a\\b
\end{bmatrix}$, point $\vec{p}=\begin{bmatrix}
  x_1\\y_1
\end{bmatrix}$, and an arbitrary vector on the line $\vec{v}=\begin{bmatrix}
  x\\y
\end{bmatrix}$, then the normal equation is

$$\vec{n}\cdot \vec{v}=\vec{n}\cdot\vec{p}.$$

Using the variables we have 

$$\begin{bmatrix}
  a\\b
\end{bmatrix}\cdot \begin{bmatrix}
  x\\y
\end{bmatrix}=\begin{bmatrix}
  a\\b
\end{bmatrix}\cdot\begin{bmatrix}
  x_1\\y_1
\end{bmatrix}.$$

Writing out the dot product, we get

$$ax+by=ax_1+by_1=c,$$

where $c$ is just a single placeholder for the constant $ax_1+by_1$. This is the standard form of a line, from which we can manipulate to get $y=mx+b$.

So, indeed, lines in $\RR^2$ and planes in $\RR^3$ can be both characterized by a point and a normal vector. This is actually true of any hyperplane, so long as the dimension of the hyperplane is one less than the ambient space dimension.

So, a hyperplane in $\RR^5$ is a $4-$dimensional subsplace characterized by the vector equation

$$\vec{n}\cdot(\vec{v}-\vec{p})=0$$

and the standard equation

$$ax+by+cz+dw=e.$$

This can be true of any finite dimensional space!

\begin{definition}
  The {\bf normal equation} of a $n-1$-dimensional hyperplane in $\RR^n$ is given as

  $$\vec{n}\cdot(\vec{v}-\vec{p})=0$$

  where $\vec{n}$ is the normal vector of the hyperplane and $\vec{p}$ is the centering point, and $\vec{v}$ is any other point on the plane.

  The standard equation is 

  $$a_1x_1+a_2x_2+\ldots+a_nx_n=c$$

  where $a_k$ are the coordinates of $\vec{n}$ and $x_k$ are the coordinates of $\vec{v}$.
\end{definition}


\end{document}

equation of the form $ax+by=d$ is a linear equation whose graph is a line in $\RR^2$. If we solve for $y$ in terms of $x$, we obtain a more familiar form of this equation, $y=-\frac{a}{b}x+\frac{d}{b}$.  The slope of the corresponding line is $m=-\frac{a}{b}$.  Observe that a line perpendicular to this line has the slope $\frac{b}{a}$.  If we interpret $a$ as a horizontal ``run" and $b$ as a vertical ``rise", we see that the vector $\begin{bmatrix}a\\b\end{bmatrix}$ is perpendicular to the line $ax+by=d$.  You can use the following GeoGebra interactive to solidify your understanding of this.
 

\begin{center}
\geogebra{tg2duwqk}{900}{600}
\end{center}

 
The idea of coefficients in front of variables forming components of a normal vector should be very familiar to you.  Recall that the graph of $ax+by+cz=d$ is a plane in $\RR^3$ with a normal vector $\vec{n}=\begin{bmatrix}a\\b\\c\end{bmatrix}$.


 
Lines and planes may seem very different, but they are all graphs of linear equations, just in different dimensions.  In general, an equation of the form
$$a_1x_1+a_2x_2+\dots +a_nx_n=d$$
is called a \dfn{linear equation} in $n$ variables.  The graph of such an equation, for $3$, is called a \dfn{hyperplane}.  The vector in $\RR^n$ whose components are the coefficients $a_1, a_2, \dots ,a_n$ is orthogonal to every vector in the hyperplane.  Unfortunately, hyperplanes are impossible to see, but we can often use insights we gain from working with lines and planes and generalize them to the invisible world of higher dimensions.

  
  Since the
  normal vector must be perpendicular to the plane, it must be
  orthogonal to both $\longvect{PQ}$ and $\longvect{PR}$. We can
  therefore use the cross product to compute a normal vector for the
  plane:
  \begin{equation*}
    \vect{n}
    ~=~
    \longvect{PQ} \times \longvect{PR}
    ~=~
    \startmat{r} 2 \\ -2 \\ -3 \stopmat
    \times
    \startmat{r} 1 \\ 1 \\ -1 \stopmat
    ~=~
    \startmat{r} 5 \\ -1 \\ 4 \stopmat.
  \end{equation*}
  \begin{center}
    \begin{tikzpicture}[rotate=-10]
      \filldraw[draw=red!80,fill=red!10](-3,0,-3.5) -- (3,0,-3.5) -- (3,0,3.5) -- (-3,0,3.5) -- cycle;
      \draw[->,thick,blue!80!black](0,0,0) -- node[left, pos=0.4] {$\vect{n}$} (100:2);
      \draw[->,thick,blue!80!black](0,0,0) -- (2,0,1);
      \draw[->,thick,blue!80!black](0,0,0) -- (1,0,-2);
      \fill (0,0,0) circle [radius=2.2pt] node [left=3pt] {$P$};
      \fill (2,0,1) circle [radius=2.2pt] node [right=3pt] {$Q$};
      \fill (1,0,-2) circle [radius=2.2pt] node [right=3pt] {$R$};
    \end{tikzpicture}
  \end{center}
  Now we can easily obtain the normal equation from any point on the
  plane (say $P$) and the normal vector we just calculated:
  \begin{equation*}
    \startmat{r} 5 \\ -1 \\ 4 \stopmat
    \dotprod
    \startmat{r} x \\ y \\ z \stopmat
    =
    \startmat{r} 5 \\ -1 \\ 4 \stopmat
    \dotprod
    \startmat{r} 0 \\ 1 \\ 3 \stopmat
  \end{equation*}
  We get the standard equation by computing the dot products on the
  left- and right-hand sides:
  \begin{equation*}
    5x - y + 4z = 11.
  \end{equation*}
  It is worthwhile to double-check the answer by substituting each of
  the three original points $P$, $Q$, and $R$ into this equation.
  For example, for $Q=(2,-1,0)$, we obtain $5(2)-(-1)+4(0)$, which is
  indeed $11$.
\end{solution}

\begin{example}{Find the normal vector of a plane}{find-normal}
  Find a normal vector for the plane $2x+3y-z=7$.
\end{example}

\begin{solution}
  The standard equation $2x+3y-z=7$ can be rewritten as a normal
  equation
  \begin{equation*}
    \startmat{r} 2\\3\\-1 \stopmat
    \dotprod
    \startmat{c} x\\y\\z \stopmat
    = 7.
  \end{equation*}
  Therefore,
  \begin{equation*}
    \vect{n} = \startmat{r} 2\\3\\-1 \stopmat
  \end{equation*}
  is a normal vector for the plane.
\end{solution}


\begin{example}{Determine whether a point is on a plane}{point-plane-normal}
  Let $\vect{n} = \startmat{c}1,2,3\stopmat^T$ be the normal vector for a plane
  which contains the point $P = (2,1,4)$. Determine if the point
  $Q = (5,4,1)$ is in this plane.
\end{example}

\begin{solution}
  By Definition~\ref{def:normal-equation-plane}, $Q$ is a point in the
  plane if and only if
  \begin{equation*}
    \vect{n} \dotprod \vect{q} = \vect{n} \dotprod \vect{p},
  \end{equation*}
  where $\vect{p}$ and $\vect{q}$ are the position vectors of $P$ and
  $Q$, respectively.  Given $\vect{n}$, $P$, and $Q$ as above, this
  equation becomes
  \begin{equation*}
    \startmat{r} 1 \\ 2 \\ 3 \stopmat
    \dotprod
    \startmat{r} 5 \\ 4 \\ 1 \stopmat
    ~=~
    \startmat{r} 1 \\ 2 \\ 3 \stopmat
    \dotprod
    \startmat{r} 2 \\ 1 \\ 4 \stopmat.
  \end{equation*}
Since both sides of the equation are equal to $16$, the equation is
  true. So the point $Q$ is indeed in the plane determined by
  $\vect{n}$ and $P$.
\end{solution}

\begin{example}{Vector equation from normal equation}{vector-from-normal}
  Find a vector equation for the plane $x+3y-2z=7$.
\end{example}

\begin{solution}
  This is the same thing as finding the general solution of a system
  of one linear equation in 3 variables. Since there is only a single
  equation $x+3y-2z=7$, it is already in {\ef}. The variables
  $y$ and $z$ are free, so we set them equal to parameters: $z=t$ and
  $y=s$. The variable $x$ is a pivot variable, and we get
  $x=7+2t-3s$. So the general solution of the equation is
  \begin{equation*}
    \startmat{c} x\\y\\z \stopmat
    = \startmat{r} 7\\0\\0 \stopmat
    + t\,\startmat{r} 2\\0\\1 \stopmat
    + s\,\startmat{r} -3\\1\\0 \stopmat.
  \end{equation*}
  This is also a vector equation for the plane.
\end{solution}

\begin{example}{Intersection of two planes}{intersection-planes}
  Find the intersection of the planes $x-2y+z=0$ and
  $2x-3y-z=4$.%
  \index{intersection!of two planes}
\end{example}



\begin{solution}
  Finding the intersection means finding all of the points $(x,y,z)$
  that are on both planes simultaneously. This is the same as solving
  the system of equations
  \begin{eqnarray*}
    x-2y+z &=& 0, \\
    2x-3y-z &=& 4.
  \end{eqnarray*}
  We solve the system by Gauss-Jordan elimination:
  \begin{equation*}
    \startmat{ccc|c}
      1 & -2 & 1 & 0 \\
      2 & -3 & -1 & 4
    \stopmat
    \stackrel{R_2\rowop R_2-2R_1}{\roweq}
    \startmat{ccc|c}
      1 & -2 & 1 & 0 \\
      0 & 1 & -3 & 4
    \stopmat
    \stackrel{R_1\rowop R_1+2R_2}{\roweq}
    \startmat{ccc|c}
      1 & 0 & -5 & 8 \\
      0 & 1 & -3 & 4
    \stopmat.
  \end{equation*}
  Therefore, the general solution is
  \begin{equation*}
    \startmat{c} x\\y\\z \stopmat
    =
    \startmat{c} 8\\4\\0 \stopmat
    + t\,\startmat{c} 5\\3\\1 \stopmat,
  \end{equation*}
  where $t$ is a parameter. This is the parametric equation of a
  line. Therefore, the two planes intersect in a line. Specifically,
  the intersection is the line through the point $(8,4,0)$ with
  direction vector $\startmat{c}5,3,1\stopmat^T$.
\end{solution}

\begin{example}{Intersection of a line and a plane}{intersection-line-plane}
  Find the intersection of the line
  \begin{equation*}
    \startmat{r} x \\ y \\ z \stopmat
    = \startmat{r} 1 \\ 2 \\ 0 \stopmat
    + t \startmat{r} -1 \\ 1 \\ 2 \stopmat
  \end{equation*}
  and the plane $2x+2y-z = 2$.%
  \index{intersection!of a line and a plane}
\end{example}

\begin{solution}
  Let us write
  \begin{equation*}
    \vect{p}=\startmat{c}1\\2\\0\stopmat,
    \quad
    \vect{d}=\startmat{c}-1\\1\\2\stopmat,
    \quad
    \vect{n}=\startmat{c}2\\2\\-1\stopmat,
    \quad\mbox{and}\quad
    \vect{q}=\startmat{c}x\\y\\z\stopmat.
  \end{equation*}
  Then the equation of the line is $\vect{q}=\vect{p}+t\,\vect{d}$ and
  the equation of the plane is
  $\vect{n}\dotprod\vect{q}=2$. Substituting the first equation into
  the second one, we get $\vect{n}\dotprod(\vect{p}+t\,\vect{d}) = 2$.
  Using distributivity of the dot product, we can write this last
  equation as
  $\vect{n}\dotprod\vect{p} + t(\vect{n}\dotprod\vect{d}) = 2$.  By
  computing the dot products $\vect{n}\dotprod\vect{p}=6$ and
  $\vect{n}\dotprod\vect{d} = -2$, this equation simplifies to
  $6-2t=2$, or $t=2$. Therefore, the line intersects the plane when
  $t=2$, or at the point
  \begin{equation*}
    \startmat{r} x \\ y \\ z \stopmat
    = \startmat{r} 1 \\ 2 \\ 0 \stopmat
    + 2 \startmat{r} -1 \\ 1 \\ 2 \stopmat
    = \startmat{r} -1 \\ 4 \\ 4 \stopmat.
  \end{equation*}
  An alternative method is to directly substitute the parametric
  equation of the line, $x=1-t$, $y=2+t$, and $z=2t$, into the
  equation of the plane, $2x+2y-z = 2$. In this case, we get
  $2(1-t)+2(2+t)-(2t)=2$, which we can solve for $t$ to obtain $t=2$.
\end{solution}

The next few examples are concerned with calculating angles between
planes, angles between lines and planes, and finding the distance
between points and planes.

\begin{example}{Find the angle between two planes}{angle-planes}
  Find the angle between the planes $7x-y=5$ and $4x+3y+5z=3$.%
  \index{angle!between two planes}%
  \index{plane!angle between}
\end{example}

\begin{solution}
  The angle between two planes is the same thing as the angle between
  their normal vectors.
  \begin{center}
    \begin{tikzpicture}
      \filldraw[draw=red!80,fill=red!10] (-3,-1,-3) -- (0,0,-3) -- (0,0,3) -- (-3,-1,3) -- cycle;
      \filldraw[draw=red!80,fill=red!15] (-3,1,-3) -- (3,-1,-3) -- (3,-1,3) -- (-3,1,3) -- cycle;
      \filldraw[draw=red!80,fill=red!10] (0,0,-3) -- (3,1,-3) -- (3,1,3) -- (0,0,3) -- cycle;
      \filldraw[fill=green!20,draw=green!50!black] (0,0,3) -- +(-18.4:12mm) arc (-18.4:18.4:12mm) -- cycle;
      \filldraw[fill=green!20,draw=green!50!black] (0,0,0) -- +(71.6:12mm) arc (71.6:108.4:12mm) -- cycle;
      \draw[red!80] (3,1,3) -- (-3,-1,3);
      \draw[red!80] (3,-1,3) -- (-3,1,3);
      \draw[->,thick,blue!80!black](0,0,0) -- node[left, near end] {$\vect{n}_1$} (-1,3,0);
      \draw[->,thick,blue!80!black](0,0,0) -- node[right, near end] {$\vect{n}_2$} (1,3,0);
      \fill (0,0,0) circle [radius=2.2pt];
      \node at (0,0,0) [above=5mm] {$\theta$};
      \node at (0,0,3) [right=5mm] {$\theta$};
    \end{tikzpicture}
  \end{center}
  The normal vectors are $\vect{n}_1 = \startmat{c}7,-1,0\stopmat^T$ and $\vect{n}_2
  = \startmat{c}4,3,5\stopmat^T$. The angle between them is given by
    \begin{equation*}
    \cos\theta =
    \frac{\vect{n}_1\dotprod\vect{n}_2}{\norm{\vect{n}_1}\norm{\vect{n}_2}}
    = \frac{25}{50} = \frac{1}{2}.
  \end{equation*}
  Therefore, the angle is $\arccos(\frac{1}{2}) = \pi/3$, or 60 degrees.
\end{solution}

\begin{example}{Find the angle between a line and a plane}{angle-line-plane}
  Find the angle between the line
  \begin{equation*}
    \startmat{r} x \\ y \\ z \stopmat
    = \startmat{r} 1 \\ 2 \\ 0 \stopmat
    + t \startmat{r} 2 \\ -1 \\ -2 \stopmat
  \end{equation*}
  and the plane $2x+2y-z = 2$.%
  \index{angle!between line and plane}
\end{example}

\begin{solution}
  To get the angle $\theta$ between the plane and the line, we can
  compute the angle $\phi$ between the direction vector of the line
  and the normal vector of the plane, and then take
  $\theta = \frac{\pi}{2}-\phi$.
  \begin{center}
    \begin{tikzpicture}[rotate=-10]
      \draw[thick, red!80] (50:-3) -- (0,0);
      \filldraw[draw=red!80,fill=red!10](-3,0,-3.5) -- (3,0,-3.5) -- (3,0,3.5) -- (-3,0,3.5) -- cycle;
      \filldraw[fill=yellow!20,draw=yellow!50!black] (0,0) -- (0:12mm) arc (0:50:12mm) -- cycle;
      \filldraw[fill=green!20,draw=green!50!black] (0,0) -- (50:12mm) arc (50:100:12mm) -- cycle;
      \draw[thick, red!80] (0,0) -- (50:3.5);
      \begin{scope}
        \clip (-3,0,-3.5) -- (3,0,-3.5) -- (3,0,3.5) -- (-3,0,3.5) -- cycle;
        \draw[thick, red!30] (50:-3) -- (0,0);
      \end{scope}
      \draw[->,thick,blue!80!black](0,0,0) -- node[left=3pt, pos=0.9] {$\vect{n}$} (100:2);
      \draw[->,thick,blue!80!black](0,0) -- node[above left, pos=0.7] {$\vect{d}$} (50:3);
      \draw[dashed] (0,0,0) -- (2.5,0,0);
      \draw[dashed] (50:3) -- +(100:-2.3);
      \fill (0,0,0) circle [radius=2.2pt];
      \node at (25:8mm) {$\theta$};
      \node at (75:7mm) {$\phi$};
    \end{tikzpicture}
  \end{center}
  The direction vector of the line is $\startmat{c}2,-1,-2\stopmat^T$ and the normal
  vector of the plane is $\startmat{c}2,2,-1\stopmat$. We have
  \begin{equation*}
    \cos\phi =
    \frac{\vect{n}\dotprod\vect{d}}{\norm{\vect{n}}\norm{\vect{d}}}
    = \frac{4}{9},
  \end{equation*}
  and therefore $\phi = \arccos(\frac{4}{9}) \approx 1.11$ radians. We
  have $\theta = \frac{\pi}{2} - \phi \approx 0.46$ radians, or about
  26.4 degrees.
\end{solution}

\begin{example}{Shortest distance from a point to a plane}{shortest-distance-plane}
  Find the shortest distance from the point $P = (3,2,3)$ to the plane
  given by $2x + y + 2z = 2$, and find the point $Q$ on the plane that
  is closest to $P$.%
  \index{distance!point to plane}%
  \index{projection!point to plane}
\end{example}

\begin{solution}
  In this problem, we are going to use the projection of one vector
  onto another, which was introduced in
  Section~\ref{ssec:projections}.  Pick an arbitrary point $R$ on
  the plane. Then, it follows that
  \begin{equation*}
    \longvect{QP} = \proj_{\vect{n}}\,\longvect{RP}
  \end{equation*}
  and $\norm{\longvect{QP}}$ is the shortest distance from $P$ to the
  plane. Further, the position vector of the point $Q$ can be computed
  as $\vect{q} = \vect{p} - \longvect{QP}$, where $\vect{p}$ is the
  position vector of $P$.
  \begin{center}
    \begin{tikzpicture}[x={(1cm,-0.2cm)},y={(0.5cm,0.5cm)},z={(0cm,1cm)}]
      \filldraw[draw=red!80,fill=red!10](-3,-2,0) -- (4,-2,0) -- (4,2,0) -- (-3,2,0) -- cycle;
      \draw[dashed](0,0,0) -- (2,0,0) -- (2,0,3) -- (0,0,3) -- cycle;
      \draw[->,thick,blue!80!black](0,0,0) -- node[left=3pt] {$\vect{n}$} (0,0,2);
      \draw[->,thick,blue!80!black](0,0,0) -- node[left=3pt, pos=0.7] {$\longvect{RP}$} (2,0,3);
      \draw[->,thick,blue!80!black](2,0,0) -- node[right=3pt, pos=0.7] {$\longvect{QP}$} (2,0,3);
      \fill (0,0,0) circle [radius=2.2pt] node [left=3pt] {$R$};
      \fill (2,0,3) circle [radius=2.2pt] node [right=3pt] {$P$};
      \fill (2,0,0) circle [radius=2.2pt] node [right=3pt] {$Q$};
    \end{tikzpicture}
  \end{center}
  From the above scalar equation, we have that $\vect{n} =
  \startmat{c} 2 \\ 1 \\ 2 \stopmat$.  Now, choose any
  point on the plane, for example, $R = (1,0,0)$ (notice that this
  satisfies $2x+y+2z=2$).  Then,
  \begin{equation*}
    \longvect{RP} = \startmat{c} 3 \\ 2 \\ 3 \stopmat
    - \startmat{c} 1 \\ 0 \\ 0 \stopmat =
    \startmat{c} 2 \\ 2 \\ 3 \stopmat.
  \end{equation*}
  Next, compute $\longvect{QP} = \proj_{\vect{n}}\longvect{RP}$.
  \begin{equation*}
    \longvect{QP} ~=~ \proj_{\vect{n}}\longvect{RP}
    ~=~ \paren{\frac{\vect{n}\dotprod\longvect{RP}}{\norm{\vect{n}}^2}}\vect{n}
    ~=~ \frac{12}{9} \startmat{r} 2 \\ 1 \\ 2 \stopmat
    ~=~ \frac{4}{3} \startmat{r} 2 \\ 1 \\ 2 \stopmat.
  \end{equation*}
  Then, $\norm{\longvect{QP}} = 4$ so the shortest distance from $P$
  to the plane is $4$.  To find the point $Q$ on the plane that is
  closest to $P$, we have
  \begin{equation*}
    \vect{q} ~=~ \vect{p} - \longvect{QP}
    ~=~ \startmat{r} 3 \\ 2 \\ 3 \stopmat
    -
    \frac{4}{3} \startmat{r} 2 \\ 1 \\ 2 \stopmat
    ~=~
    \frac{1}{3}
    \startmat{r} 1 \\ 2 \\ 1 \stopmat.
  \end{equation*}
  Therefore, $Q = (\frac{1}{3},\frac{2}{3},\frac{1}{3})$.
\end{solution}

\end{document}

